<h1><%= link_to strip_tags(@article.title), gazette_article_url(@article.gazette, @article) %></h1>
<h2><%= strip_tags(@article.sub_title) %></h2>
<h3>Published in <%= link_to @article.gazette.name, gazette_articles_url(@article.gazette) %></h3>
<h3><%= @article.created_at %></h3>

<%# We want to display the article's html tags %>
<p><%= raw(@article.content) %></p>

<ul class="photos-list">
	<% @article.photos.each do |photo| %>
	  <% photo_date = photo.taken_date.strftime("%b %-d at %H:%M") %>
		<li class="photo-item" id="item_<%= photo.id %>" 
		  tags="<% photo.tags.each { |tag| %><%= strip_tags(tag.name) %>,<% } %>">
			<div class="image-vertical-align">
			  <div class="image-horizontal-align">
			    <%= link_to image_tag(@photos_dir + photo.select_fichier('thumbnail').filename,
            class: "photo-thumbnail"), photo_path(photo, tags: params[:tags]) %>
        </div>
			</div>
			<span class="photo-title"><%= strip_tags(photo.title) %></span>
			<span class="photo-date"><%= strip_tags(photo_date) %></span>
		</li>
	<% end %>
</ul>

<div class="meta-data">
  <div class="commentary">
  	<h2>Comments</h2>
  	<ul>
  		<% @article.comments.select { |c| c.id != nil }.each do |comment| %>
  		<% comment_date = comment.created_at.localtime.strftime("%b %-d at %-H:%-M") %>
  			<li>
  				<%= strip_tags(comment.content) %> â€“ by <span class="user"><%= strip_tags(comment.user) %></span> on <span class="date"><%= strip_tags(comment_date) %></span>
  			</li>
  		<% end %>
  	</ul>
  	<div>
  		<button id="add-comment-button">New comment</button>
  		<div id="new-comment">
  			<%= render partial: 'comments/form', locals: { commentable: @article } %>
  		</div>
  	</div>
  </div>
</div>

<% if @is_logged_in %>
  <%= link_to 'Edit', edit_gazette_article_path(@article.gazette_id, @article) %> |
  <%= link_to 'Back', gazette_articles_path(@article.gazette_id) %>
<% end %>